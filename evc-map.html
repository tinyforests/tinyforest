<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Find My Ecological Garden | Gardener & Son</title>
  <!-- Fonts & Leaflet CSS -->
  <link
    href="https://fonts.googleapis.com/css2?family=Abril+Fatface&family=IBM+Plex+Mono:wght@300;400;500;700&display=swap"
    rel="stylesheet"
  />
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
  />
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: "IBM Plex Mono", monospace;
      background-color: #fff0dc;
      color: #3d4535;
      overflow-x: hidden;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    /* Hero Section */
    #container {
      min-height: 80vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 3rem 2rem;
      max-width: 900px;
      margin: 0 auto;
      position: relative;
    }

    #page-title {
      font-family: "Abril Fatface", serif;
      font-size: clamp(3rem, 10vw, 6rem);
      letter-spacing: 0px;
      line-height: 1;
      text-align: center;
      margin-bottom: 2rem;
      animation: fadeInUp 0.8s ease-out;
    }

    .hero-highlight {
      font-size: clamp(1.1rem, 2.5vw, 1.4rem);
      line-height: 1.7;
      text-align: center;
      margin-bottom: 2rem;
      font-weight: 400;
      max-width: 700px;
      animation: fadeInUp 1s ease-out;
      background: rgba(255, 255, 255, 0.5);
      padding: 1.5rem 2rem;
      border-radius: 12px;
    }

    #container > p:not(.hero-highlight) {
      font-size: clamp(0.95rem, 2vw, 1.1rem);
      text-align: center;
      margin-bottom: 2.5rem;
      opacity: 0.8;
      animation: fadeInUp 1.2s ease-out;
    }

    /* Search Container */
    #search-container {
      width: 100%;
      max-width: 600px;
      display: flex;
      flex-direction: column;
      gap: 1rem;
      animation: fadeInUp 1.4s ease-out;
    }

    #address-form {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    #address-input {
      padding: 1.2rem 1.5rem;
      font-family: "IBM Plex Mono", monospace;
      font-size: 1rem;
      border: 2px solid #3d4535;
      border-radius: 50px;
      background-color: white;
      color: #3d4535;
      outline: none;
      transition: all 0.3s ease;
    }

    #address-input:focus {
      border-color: #3d4535;
      box-shadow: 0 4px 20px rgba(61, 69, 53, 0.15);
    }

    #address-input::placeholder {
      color: #999;
    }

    #search-button,
    #location-button {
      padding: 1.2rem 2.5rem;
      background-color: #3d4535;
      color: #fff0dc;
      border: none;
      border-radius: 50px;
      font-family: "IBM Plex Mono", monospace;
      font-weight: 700;
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
    }

    #search-button:hover,
    #location-button:hover {
      transform: scale(1.03) rotate(0.5deg);
      box-shadow: 0 8px 25px rgba(61, 69, 53, 0.25);
    }

    #search-button:active,
    #location-button:active {
      transform: scale(0.98);
    }

    #search-button:disabled,
    #location-button:disabled {
      opacity: 0.7;
      cursor: not-allowed;
      transform: none;
    }

    #location-button {
      background-color: transparent;
      border: 2px solid #3d4535;
      color: #3d4535;
      font-weight: 500;
    }

    #location-button:hover {
      background-color: #3d4535;
      color: #fff0dc;
    }

    /* Map - Hidden */
    #map {
      display: none;
    }

    /* Modal */
    #evc-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(61, 69, 53, 0.95);
      z-index: 9999;
      align-items: center;
      justify-content: center;
      padding: 40px 20px;
      animation: fadeIn 0.3s ease-out;
    }

    .modal-content {
      background-color: #fff0dc;
      border-radius: 20px;
      max-width: 900px;
      width: 100%;
      max-height: 85vh;
      overflow-y: auto;
      overflow-x: hidden;
      position: relative;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      animation: slideUp 0.4s ease-out;
      -webkit-overflow-scrolling: touch;
    }

    #modal-map {
      width: 100%;
      height: 300px;
      border-radius: 20px 20px 0 0;
    }

    #modal-close {
      position: fixed;
      top: calc(env(safe-area-inset-top, 0px) + 15px);
      right: calc(env(safe-area-inset-right, 0px) + 15px);
      background-color: #3d4535;
      color: #fff0dc;
      border: none;
      border-radius: 50%;
      width: 45px;
      height: 45px;
      font-size: 28px;
      line-height: 1;
      cursor: pointer;
      z-index: 10001;
      transition: all 0.2s ease;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
    }

    #modal-close:hover {
      transform: scale(1.1) rotate(90deg);
      background-color: #2f3928;
    }

    #modal-info {
      padding: 2.5rem;
    }

    #modal-info .title {
      font-size: 0.95rem;
      text-transform: uppercase;
      letter-spacing: 2px;
      opacity: 0.7;
      margin-bottom: 0.5rem;
    }

    #modal-evc-name {
      font-family: "Abril Fatface", serif;
      font-size: clamp(2rem, 5vw, 3rem);
      color: #3d4535;
      margin-bottom: 1.5rem;
      line-height: 1.1;
      letter-spacing: 0px;
    }

    #modal-info .status,
    #modal-info .region {
      margin-bottom: 1rem;
      font-size: 1rem;
    }

    #modal-evc-description {
      font-size: 1.05rem;
      line-height: 1.8;
      margin: 1.5rem 0;
      padding: 1.5rem;
      background-color: rgba(255, 255, 255, 0.5);
      border-radius: 12px;
      border: 1px solid #e2e8f0;
    }

    #modal-plants {
      margin-top: 2rem;
    }

    #email-section {
      background: linear-gradient(135deg, #3d4535 0%, #2f3928 100%);
      padding: 3rem 2.5rem;
      color: #fff0dc;
      border-radius: 0 0 20px 20px;
      text-align: center;
    }

    #email-section h2 {
      font-family: "Abril Fatface", serif;
      font-size: clamp(1.8rem, 4vw, 2.5rem);
      margin-bottom: 1rem;
      letter-spacing: 0px;
    }

    #email-section p {
      font-size: 1rem;
      margin-bottom: 2rem;
      opacity: 0.9;
    }

    #gf-form {
      display: flex;
      flex-direction: column;
      gap: 1rem;
      max-width: 500px;
      margin: 0 auto;
    }

    #gf-email {
      padding: 1.2rem 1.5rem;
      font-family: "IBM Plex Mono", monospace;
      font-size: 1rem;
      border: 2px solid #fff0dc;
      border-radius: 50px;
      background-color: rgba(255, 240, 220, 0.1);
      color: #fff0dc;
      outline: none;
      transition: all 0.3s ease;
    }

    #gf-email::placeholder {
      color: rgba(255, 240, 220, 0.6);
    }

    #gf-email:focus {
      background-color: rgba(255, 240, 220, 0.2);
      box-shadow: 0 4px 20px rgba(255, 240, 220, 0.1);
    }

    #gf-form button {
      padding: 1.2rem 2.5rem;
      background-color: #fff0dc;
      color: #3d4535;
      border: none;
      border-radius: 50px;
      font-family: "IBM Plex Mono", monospace;
      font-weight: 700;
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
    }

    #gf-form button:hover {
      transform: scale(1.05);
      box-shadow: 0 8px 25px rgba(255, 240, 220, 0.3);
    }

    /* Footer */
    footer {
      margin-top: 0;
      padding: 50px 20px;
      background-color: #3d4535;
      color: #fff0dc;
      text-align: center;
    }

    footer .acknowledgement {
      max-width: 800px;
      margin: 0 auto;
      padding: 2rem;
      background-color: rgba(255, 240, 220, 0.05);
      border-radius: 8px;
      text-align: left;
      line-height: 1.8;
    }

    footer .acknowledgement p {
      font-size: 13px;
      line-height: 1.8;
      margin-bottom: 30px;
      font-weight: 300;
    }

    footer .acknowledgement p:last-child {
      margin-bottom: 0;
    }

    footer > p {
      margin-top: 40px;
      font-size: 12px;
      opacity: 0.8;
    }

    footer a {
      color: #fff0dc;
      text-decoration: underline;
      transition: opacity 0.2s ease;
    }

    footer a:hover {
      opacity: 0.8;
    }

    /* Animations */
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
      }
      to {
        opacity: 1;
      }
    }

    @keyframes slideUp {
      from {
        transform: translateY(50px);
        opacity: 0;
      }
      to {
        transform: translateY(0);
        opacity: 1;
      }
    }

    /* Responsive */
    @media (max-width: 768px) {
      #container {
        padding: 2rem 1.2rem;
        min-height: 90vh;
      }

      #page-title {
        font-size: clamp(3rem, 13vw, 5rem);
        margin-bottom: 1.5rem;
      }

      .hero-highlight {
        font-size: 1.05rem;
        margin-bottom: 1.5rem;
        line-height: 1.6;
        padding: 1.2rem 1.5rem;
      }

      #container > p:not(.hero-highlight) {
        font-size: 0.95rem;
        margin-bottom: 2rem;
      }

      #search-container {
        max-width: 100%;
      }

      #address-input {
        padding: 1rem 1.2rem;
        font-size: 16px; /* Prevents zoom on iOS */
      }

      #search-button,
      #location-button {
        padding: 1rem 2rem;
        font-size: 0.95rem;
      }

      #address-form {
        gap: 0.8rem;
      }

      /* Modal optimizations */
      #evc-modal {
        padding: 20px 10px;
        padding-top: env(safe-area-inset-top, 20px);
      }

      .modal-content {
        max-height: 90vh;
        border-radius: 15px;
      }

      #modal-map {
        height: 200px;
        border-radius: 15px 15px 0 0;
      }

      #modal-close {
        top: calc(env(safe-area-inset-top, 0px) + 10px);
        right: calc(env(safe-area-inset-right, 0px) + 10px);
        width: 40px;
        height: 40px;
        font-size: 24px;
      }

      #modal-info {
        padding: 1.5rem 1.2rem;
      }

      #modal-info .title {
        font-size: 0.85rem;
      }

      #modal-evc-name {
        font-size: 2.5rem;
        margin-bottom: 1rem;
      }

      #modal-info .status,
      #modal-info .region {
        font-size: 0.9rem;
      }

      #modal-evc-description {
        font-size: 0.95rem;
        padding: 1.2rem;
        line-height: 1.7;
      }

      #email-section {
        padding: 2rem 1.2rem;
      }

      #email-section h2 {
        font-size: clamp(1.5rem, 5vw, 2rem);
        margin-bottom: 0.8rem;
      }

      #email-section p {
        font-size: 0.9rem;
        margin-bottom: 1.5rem;
      }

      #gf-email {
        padding: 1rem 1.2rem;
        font-size: 16px; /* Prevents zoom on iOS */
      }

      #gf-form button {
        padding: 1rem 2rem;
        font-size: 0.95rem;
      }

      /* Footer mobile */
      footer {
        padding: 40px 15px;
      }

      footer .acknowledgement {
        padding: 1.5rem;
        margin: 0 auto;
      }

      footer .acknowledgement p {
        font-size: 14px;
        line-height: 1.7;
        margin-bottom: 20px;
      }

      footer > p {
        font-size: 13px;
        margin-top: 30px;
        padding: 0 10px;
      }
    }

    /* Extra small devices */
    @media (max-width: 480px) {
      #container {
        padding: 1.5rem 1rem;
      }

      #page-title {
        font-size: 2.8rem;
        margin-bottom: 1.2rem;
      }

      .hero-highlight {
        font-size: 1rem;
        padding: 1rem 1.2rem;
      }

      #address-input,
      #search-button,
      #location-button {
        padding: 0.9rem 1rem;
      }

      #modal-info {
        padding: 1.2rem 1rem;
      }

      #email-section {
        padding: 1.8rem 1rem;
      }

      footer .acknowledgement {
        padding: 1.2rem;
      }

      footer .acknowledgement p {
        font-size: 13px;
        margin-bottom: 15px;
      }

      footer > p {
        font-size: 12px;
      }
    }
  </style>
</head>
<body>
  <div id="container">
    <h2 id="page-title">Find My Ecological Garden.</h2>
    <p class="hero-highlight">
      Planting indigenous species helps restore local biodiversity, support native wildlife, and build climate resilience right from your own garden.
    </p>
    <p>
      Enter your address to discover your Ecological Vegetation Class and find what plants belong in your garden.
    </p>
    <div id="search-container">
      <form id="address-form">
        <input
          type="text"
          id="address-input"
          placeholder="Enter your address"
          required
        />
        <button id="search-button" type="submit">
          Find My Garden
        </button>
      </form>
      <button id="location-button" type="button">
        üìç Use My Location
      </button>
    </div>
    <!-- legacy map (hidden via CSS) -->
    <div id="map"></div>
  </div>
  
  <!-- Footer -->
  <footer>
    <div class="acknowledgement">
      <p>
        At Gardener & Son, we acknowledge the Wurundjeri Woi Wurrung people of the Kulin Nation, the Traditional Custodians of the land on which we live and work.
        We pay deep respect to their Elders ‚Äî past and present ‚Äî and to all First Nations people whose enduring connection to Country continues to guide and inspire us.
      </p>
      <p>
        We also acknowledge the ecologies that once thrived here ‚Äî the grasslands, woodlands, and wetlands shaped by thousands of years of cultural care and ecological balance.
        These living systems were not lost to time, but to disconnection. Our work seeks to rekindle that relationship, restoring native ecologies, honouring local geology, and weaving biodiversity back into the urban fabric.
        Each garden we design is an act of remembrance and renewal ‚Äî a gesture toward healing both Country and ecology.
      </p>
    </div>
    <p>
      Lovingly made in Melbourne by <a href="https://www.gardenerandson.com" target="_blank">Gardener & Son</a>.
    </p>
  </footer>

  <!-- Modal -->
  <div id="evc-modal">
    <div class="modal-content">
      <div id="modal-map"></div>
      <button id="modal-close">&times;</button>
      <div id="modal-info">
        <p class="title">Your Ecological Vegetation is:</p>
        <p id="modal-evc-name"></p>
        <p class="status"><strong>Status:</strong> <span id="modal-evc-status"></span></p>
        <p class="region"><strong>Bioregion:</strong> <span id="modal-evc-region"></span></p>
        <p id="modal-evc-description"></p>
        
        <!-- Plant list container -->
        <div id="modal-plants"></div>
      </div>
      <!-- SIGN UP SECTION -->
      <div id="email-section">
        <h2>Join the ecological movement</h2>
        <p>Sign up to receive updates, planting tips, and stories from ecological gardens across Victoria.</p>
        <form
          id="gf-form"
          action="https://docs.google.com/forms/d/e/1FAIpQLScQPHZI3_aT51WnDUpszhO03xYKPVJ76r9uiKC6KoZDP8oXYQ/formResponse"
          method="POST"
          target="gf-iframe"
        >
          <input type="hidden" name="entry.1492023911" id="gf-address"/>
          <input type="hidden" name="entry.1435626710" id="gf-evcCode"/>
          <input
            type="email"
            name="entry.732959100"
            id="gf-email"
            placeholder="you@example.com"
            required
          />
          <button type="submit">Join the movement</button>
        </form>
        <iframe name="gf-iframe" style="display:none;"></iframe>
      </div>
    </div>
  </div>

  <!-- Pre-Order Modal -->
  <div id="preorder-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(61, 69, 53, 0.95); z-index: 10000; align-items: center; justify-content: center; padding: 40px 20px;">
    <div style="background-color: #fff0dc; border-radius: 20px; max-width: 600px; width: 100%; max-height: 85vh; overflow-y: auto; position: relative; box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3); padding: 2.5rem;">
      <button id="preorder-close" style="position: absolute; top: 15px; right: 15px; background-color: #3d4535; color: #fff0dc; border: none; border-radius: 50%; width: 45px; height: 45px; font-size: 28px; line-height: 1; cursor: pointer; transition: all 0.2s;">&times;</button>
      
      <h2 style="font-family: 'Abril Fatface', serif; font-size: clamp(1.8rem, 5vw, 2.5rem); color: #3d4535; margin-bottom: 1rem;">Pre-Order Your Tiny Forest Kit</h2>
      <p style="margin-bottom: 2rem; color: #666;">We're excited to help you create your tiny forest! Fill out the form below and we'll be in touch to finalize your order.</p>
      
      <form id="preorder-form" action="https://docs.google.com/forms/d/e/1FAIpQLSdzMYnUrg7FuTkNk9_5u2VXV6Ea0LrRWE-_paKu7gFIdz7fWw/formResponse" method="POST" target="preorder-iframe" style="display: flex; flex-direction: column; gap: 1.2rem;">
        
        <div>
          <label for="preorder-name" style="display: block; margin-bottom: 0.5rem; font-weight: 500;">Name *</label>
          <input type="text" id="preorder-name" name="entry.1168713650" required style="width: 100%; padding: 1rem; font-family: 'IBM Plex Mono', monospace; font-size: 1rem; border: 2px solid #3d4535; border-radius: 50px; background-color: white; outline: none;">
        </div>
        
        <div>
          <label for="preorder-email" style="display: block; margin-bottom: 0.5rem; font-weight: 500;">Email *</label>
          <input type="email" id="preorder-email" name="entry.403953874" required style="width: 100%; padding: 1rem; font-family: 'IBM Plex Mono', monospace; font-size: 1rem; border: 2px solid #3d4535; border-radius: 50px; background-color: white; outline: none;">
        </div>
        
        <div>
          <label for="preorder-phone" style="display: block; margin-bottom: 0.5rem; font-weight: 500;">Phone *</label>
          <input type="tel" id="preorder-phone" name="entry.963420574" required style="width: 100%; padding: 1rem; font-family: 'IBM Plex Mono', monospace; font-size: 1rem; border: 2px solid #3d4535; border-radius: 50px; background-color: white; outline: none;">
        </div>
        
        <div>
          <label for="preorder-address" style="display: block; margin-bottom: 0.5rem; font-weight: 500;">Property Address (auto-filled, you can edit)</label>
          <textarea id="preorder-address" name="entry.463300287" placeholder="Where will you be planting your forest kit?" style="width: 100%; padding: 1rem; font-family: 'IBM Plex Mono', monospace; font-size: 1rem; border: 2px solid #3d4535; border-radius: 12px; background-color: white; outline: none; min-height: 80px; resize: vertical;"></textarea>
        </div>
        
        <div>
          <label for="preorder-area" style="display: block; margin-bottom: 0.5rem; font-weight: 500;">Approximate Area (m¬≤) *</label>
          <input type="number" id="preorder-area" name="entry.2073002838" required placeholder="e.g., 50" style="width: 100%; padding: 1rem; font-family: 'IBM Plex Mono', monospace; font-size: 1rem; border: 2px solid #3d4535; border-radius: 50px; background-color: white; outline: none;">
        </div>
        
        <div>
          <label for="preorder-evc" style="display: block; margin-bottom: 0.5rem; font-weight: 500;">Preferred EVC</label>
          <input type="text" id="preorder-evc" name="entry.10172062" style="width: 100%; padding: 1rem; font-family: 'IBM Plex Mono', monospace; font-size: 1rem; border: 2px solid #e2e8f0; border-radius: 50px; background-color: #f5f5f5; outline: none; color: #666;">
        </div>
        
        <button type="submit" style="padding: 1.2rem 2.5rem; background-color: #3d4535; color: #fff0dc; border: none; border-radius: 50px; font-family: 'IBM Plex Mono', monospace; font-weight: 700; font-size: 1rem; cursor: pointer; transition: all 0.3s; margin-top: 1rem;">Submit Pre-Order</button>
      </form>
      
      <iframe name="preorder-iframe" style="display:none;"></iframe>
    </div>
  </div>

  <!-- Leaflet, Turf & fetch logic -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="https://unpkg.com/@turf/turf/turf.min.js"></script>
  <script src="evc-fetch.js"></script>
</body>
</html>
